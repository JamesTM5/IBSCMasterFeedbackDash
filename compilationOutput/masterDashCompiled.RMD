---
title: "IBSC Dash"
output:
  flexdashboard::flex_dashboard:
    orientation: columns
    social: menu
    vertical_layout: fill
runtime: shiny
resource_files:
- assets/d3.min.js
- assets/forcedirected/binding.js
- assets/forcedirected/fd.js
- assets/forcedirected/repeated-fd.js
- assets/forcedirected/styles.css
---
```{r setup, include=FALSE}

#install and call all relevant libraries
packages = c('rmarkdown', 'jsonlite', 'tidyverse')
invisible(lapply(packages, library, character.only = TRUE))

#read in all files
files = list.files(path = paste(".", "data", sep = "/"), pattern = '^.*rds$')
fileList <- list()
for (i in 1:length(files)) {
  file <- readRDS(paste("./data", files[i], sep = "/"))
  name <- as.character(files[i])
  fileList[[name]] <- file
}

#source all .R scripts in ./assets/R/
file.sources = list.files(path = "./assets/R/", pattern="*.R$")
file.sources <- sapply(file.sources,function(x){paste("./assets/R/", x, sep = "")})
for(i in 1:length(file.sources)){
  source(file.sources[[i]])
}

#set an arbitary seed
set.seed (fileList[[1]]$seed)


d3RQPrepSingleInstance(fileList=fileList)
'dupnlmffjcatgle'
```

Scots 7TGAN1 RQ1 Relationship Question
=======================================================================
  
Headlines {data-width=200}
--------------------------------------------------------------------------

### Question Statement: Relationships Question 1

```{r}
valueBox(
  "RQ1",
  caption = NULL,
  color = '#186ecc',
  icon = "fa-comment"
)
```

### {-}

```{r}
valueBox(
  fileList[[1]]$className,
  caption = NULL,
  color = '#186ecc',
  icon = "fa-chalkboard-teacher"
)
```

### Network Health

```{r}
valueBox(
  fileList[[1]]$overallHealth[[1]][[1]],
  color = fileList[[1]]$overallHealth[[1]][[2]],
  icon = "fa-file-medical"
)
```

### Potential for Improvement

```{r}
valueBox(
  fileList[[1]]$overallPfI[[1]][[1]],
  color = fileList[[1]]$overallPfI[[1]][[2]],
  icon = "fa-chart-line"
)
```

### Our Commentary

  The data shown here is a result of analysis conducted upon the social
network data provided by completing our Relationships Foundation
Questionnaires, along with any other information provided to us by you
and/or `r fileList[[1]]$clientName`.

### Class Predictive Factors

<center>
```{r, results = 'asis'}
if (length(fileList[[1]]$homophylyList[[1]][[1]] > 0)) {
  cat(fileList[[1]]$homophylyList[[1]][[1]])
} else {
  cat("None")
}
```
</center>

>These factors statistically significantly influence the nature and function of the class

### Class Indeterminate Factors

<center>
```{r, results = 'asis'}
if (length(fileList[[1]]$homophylyList[[1]][[3]] > 0)) {
  cat(fileList[[1]]$homophylyList[[1]][[3]])
} else {
  cat("None")
}
```
</center>

>These factors could not be shown to influence the nature and function of the class at a peer-to-peer level due to limitations in the data collected

### Class Non-Predictive Factors

<center>
```{r, results = 'asis'}
if (length(fileList[[1]]$homophylyList[[1]][[2]] > 0)) {
  cat(fileList[[1]]$homophylyList[[1]][[2]])
} else {
  cat("None")
}
```
</center>

>These factors do not statistically significantly influence the nature and
function of the class

Row {data-width=250}
-----------------------------------------------------------------------

### Class Diameter

```{r}
diameter <- fileList[[1]]$totalNetworkInfo[[1]][[4]][[1]]
nodes <- length(fileList[[1]]$totalNetworkInfo[[1]][[10]])

source("./assets/R/graphConnected.R")

if(graphConnected(fileList[[1]]$SSNQGraph[[1]])== F) {
  customSectors <-  gaugeSectors (
    danger = c(0, 100)
  )
} else {
  customSectors <-  gaugeSectors (
    success = c(0,(nodes/6)),
    warning = c((nodes/6), (nodes/3)),
    danger = c((nodes/3), (nodes/2)))
}

#make gauge
gauge(round(diameter, digits = 2), min = 1, max = (nodes/2), sectors = customSectors)

#provide warning text if graph is fragmented.
if (graphConnected(fileList[[1]]$SSNQGraph[[1]]) == F) {
  SSNQConnectedWarning <- paste("However, as this group is split across ",
    "separate unconnected sub-groups, this may not be a good measure of group ",
    "cohesiveness.",
    sep = "")
} else {
  SSNQConnectedWarning <- ""
}
```
 
> The most distant people are `r round(diameter, digits=0)` relationships away
from each other. <span style="color: red;">`r SSNQConnectedWarning`</span> 

### Percentage of Positive Relationships

```{r}
edgeDensity <- fileList[[1]]$totalNetworkInfo[[1]][[5]]
edgeDensityPercentage <- round((edgeDensity*100), digits = 0)
gauge(edgeDensityPercentage, min = 0, max = 100, symbol = '%', gaugeSectors(
    success = c(21, 100), 
    warning = c(16, 20), 
    danger = c(0, 15)
  ))
```
  
> `r round(edgeDensity, digits = 2)*100`% of all possible relationships are
strongly positive.
  
### Class Reciprocity
  
```{r}
reciprocity <- fileList[[1]]$totalNetworkInfo[[1]][[6]]
reciprocityPercentage <- round((reciprocity*100), digits = 0)
gauge(reciprocityPercentage, min = 0, max = 100, symbol = '%', gaugeSectors(
    success = c(55, 100), 
    warning = c(40, 54), 
    danger = c(0, 39)
  ))
```

> Both parties agreed on a relationship status
`r round(reciprocity, digits = 2)*100`% of the time.

### Class Communities Dendrogram  {data-height=400} 
<center>
```{r}

fileList[[1]]$dendrogramList[[1]]

```
</center>

> This shows how the relational landscape divides into subgroups, mirrored in the colour of the dots on the summary graph.  The higher the number on the left, the bigger the distance between the group members attached at the split.
  

Network Maps 
----------------------------------------------------------------

### Summary graph {.no-padding data-height=700} 

```{r}

JSData1 <- jsonlite::read_json("D3JSData11.json")

repeatedforcedirectedOutput("repeatedforcedirected1")
output$repeatedforcedirected1 <- renderRepeatedforcedirected(repeatedforcedirected("Hello", JSData1))
```

> The lines on this graph represent the strongest relationships in the class. Each dot is a person, and each line is a strong relationship. The colours indicate cliques, or subgroups in the data which naturally form as people form and maintain social networks. Zoom using the scroll wheel or pinch on a touchscreen device, and drag people around to see who is connected most closely to them. The position on the graph doesn't matter itself, its about the position relative to the other people and how linked in they are with the group as a whole.

Key Network Information {data-width=250}
-----------------------------------------------------

### Class 'Hubs' {data-height=350} 

<center>
```{r, results = 'asis'}
if (length(fileList[[1]]$HSList[[1]]) > 0) {
  cat(fileList[[1]]$HSList[[1]])
} else {
  cat("Contact Volume Hub Analysis Encountered an Error")
}
```
</center>

> These people are the lifeblood of the class: Their absence would hamper communication and they make good contacts for new members to get more integrated.  They are those who report the most highly positive relationships with others.

### Class 'Authorities' {data-height=350} 

<center>
```{r, results = 'asis'}
if (length(as.character(fileList[[1]]$ASList[[1]]) > 0)) {
  cat(fileList[[1]]$ASList[[1]])
} else {
  cat("Network Authority Analysis Encountered an Error")
}
```
</center>

>These tend to be the class members who are  looked up to, or approached for advice or information by their peers: They have high value to others in the group.  They are those whom others identify as having the most highly positive relationships with.

### Fundamental Relationships  {data-height=750}

<center>
```{r, results = 'asis'}
cat(paste(fileList[[1]]$totalNetworkInfo[[1]][[9]][1,1], "<br>", "and<br>",
          fileList[[1]]$totalNetworkInfo[[1]][[9]][1,2])
    )
```

***

```{r, results = 'asis'}
cat(paste(fileList[[1]]$totalNetworkInfo[[1]][[9]][2,1], "<br>", "and<br>",
          fileList[[1]]$totalNetworkInfo[[1]][[9]][2,2])
    )
```

***

```{r, results = 'asis'}
cat(paste(fileList[[1]]$totalNetworkInfo[[1]][[9]][3,1], "<br>", "and<br>",
          fileList[[1]]$totalNetworkInfo[[1]][[9]][3,2])
    )
```
</center>

>These are the relationships which make the class operate as it does.  Promoting
these adds cohesion.

### Network Isolates

<center>
```{r, results = 'asis'}
if(!is.null(fileList[[1]]$isolatesList[[1]])) {
  cat(fileList[[1]]$isolatesList[[1]])
}
```
</center>

>These people are not joined to any others in the network by positive
relationships in at least one of the dimensions they were asked about.

Scots 7TGAN1 RQ2 Relationship Question
=======================================================================
  
Headlines {data-width=200}
--------------------------------------------------------------------------

### Question Statement: Relationships Question 2

```{r}
valueBox(
  "RQ2",
  caption = NULL,
  color = '#186ecc',
  icon = "fa-comment"
)
```

### {-}

```{r}
valueBox(
  fileList[[1]]$className,
  caption = NULL,
  color = '#186ecc',
  icon = "fa-chalkboard-teacher"
)
```

### Network Health

```{r}
valueBox(
  fileList[[1]]$overallHealth[[2]][[1]],
  color = fileList[[1]]$overallHealth[[2]][[2]],
  icon = "fa-file-medical"
)
```

### Potential for Improvement

```{r}
valueBox(
  fileList[[1]]$overallPfI[[2]][[1]],
  color = fileList[[1]]$overallPfI[[2]][[2]],
  icon = "fa-chart-line"
)
```

### Our Commentary

  The data shown here is a result of analysis conducted upon the social
network data provided by completing our Relationships Foundation
Questionnaires, along with any other information provided to us by you
and/or `r fileList[[1]]$clientName`.

### Class Predictive Factors

<center>
```{r, results = 'asis'}
if (length(fileList[[1]]$homophylyList[[2]][[1]] > 0)) {
  cat(fileList[[1]]$homophylyList[[2]][[1]])
} else {
  cat("None")
}
```
</center>

>These factors statistically significantly influence the nature and function of the class

### Class Indeterminate Factors

<center>
```{r, results = 'asis'}
if (length(fileList[[1]]$homophylyList[[2]][[3]] > 0)) {
  cat(fileList[[1]]$homophylyList[[2]][[3]])
} else {
  cat("None")
}
```
</center>

>These factors could not be shown to influence the nature and function of the class at a peer-to-peer level due to limitations in the data collected

### Class Non-Predictive Factors

<center>
```{r, results = 'asis'}
if (length(fileList[[1]]$homophylyList[[2]][[2]] > 0)) {
  cat(fileList[[1]]$homophylyList[[2]][[2]])
} else {
  cat("None")
}
```
</center>

>These factors do not statistically significantly influence the nature and
function of the class

Row {data-width=250}
-----------------------------------------------------------------------

### Class Diameter

```{r}
diameter <- fileList[[1]]$totalNetworkInfo[[2]][[4]][[1]]
nodes <- length(fileList[[1]]$totalNetworkInfo[[2]][[10]])

source("./assets/R/graphConnected.R")

if(graphConnected(fileList[[1]]$SSNQGraph[[2]])== F) {
  customSectors <-  gaugeSectors (
    danger = c(0, 100)
  )
} else {
  customSectors <-  gaugeSectors (
    success = c(0,(nodes/6)),
    warning = c((nodes/6), (nodes/3)),
    danger = c((nodes/3), (nodes/2)))
}

#make gauge
gauge(round(diameter, digits = 2), min = 1, max = (nodes/2), sectors = customSectors)

#provide warning text if graph is fragmented.
if (graphConnected(fileList[[1]]$SSNQGraph[[2]]) == F) {
  SSNQConnectedWarning <- paste("However, as this group is split across ",
    "separate unconnected sub-groups, this may not be a good measure of group ",
    "cohesiveness.",
    sep = "")
} else {
  SSNQConnectedWarning <- ""
}
```
 
> The most distant people are `r round(diameter, digits=0)` relationships away
from each other. <span style="color: red;">`r SSNQConnectedWarning`</span> 

### Percentage of Positive Relationships

```{r}
edgeDensity <- fileList[[1]]$totalNetworkInfo[[2]][[5]]
edgeDensityPercentage <- round((edgeDensity*100), digits = 0)
gauge(edgeDensityPercentage, min = 0, max = 100, symbol = '%', gaugeSectors(
    success = c(21, 100), 
    warning = c(16, 20), 
    danger = c(0, 15)
  ))
```
  
> `r round(edgeDensity, digits = 2)*100`% of all possible relationships are
strongly positive.
  
### Class Reciprocity
  
```{r}
reciprocity <- fileList[[1]]$totalNetworkInfo[[2]][[6]]
reciprocityPercentage <- round((reciprocity*100), digits = 0)
gauge(reciprocityPercentage, min = 0, max = 100, symbol = '%', gaugeSectors(
    success = c(55, 100), 
    warning = c(40, 54), 
    danger = c(0, 39)
  ))
```

> Both parties agreed on a relationship status
`r round(reciprocity, digits = 2)*100`% of the time.

### Class Communities Dendrogram  {data-height=400} 
<center>
```{r}

fileList[[1]]$dendrogramList[[2]]

```
</center>

> This shows how the relational landscape divides into subgroups, mirrored in the colour of the dots on the summary graph.  The higher the number on the left, the bigger the distance between the group members attached at the split.
  

Network Maps 
----------------------------------------------------------------

### Summary graph {.no-padding data-height=700} 

```{r}

JSData1 <- jsonlite::read_json("D3JSData11.json")

repeatedforcedirectedOutput("repeatedforcedirected1")
output$repeatedforcedirected1 <- renderRepeatedforcedirected(repeatedforcedirected("Hello", JSData1))
```

> The lines on this graph represent the strongest relationships in the class. Each dot is a person, and each line is a strong relationship. The colours indicate cliques, or subgroups in the data which naturally form as people form and maintain social networks. Zoom using the scroll wheel or pinch on a touchscreen device, and drag people around to see who is connected most closely to them. The position on the graph doesn't matter itself, its about the position relative to the other people and how linked in they are with the group as a whole.

Key Network Information {data-width=250}
-----------------------------------------------------

### Class 'Hubs' {data-height=350} 

<center>
```{r, results = 'asis'}
if (length(fileList[[1]]$HSList[[2]]) > 0) {
  cat(fileList[[1]]$HSList[[2]])
} else {
  cat("Contact Volume Hub Analysis Encountered an Error")
}
```
</center>

> These people are the lifeblood of the class: Their absence would hamper communication and they make good contacts for new members to get more integrated.  They are those who report the most highly positive relationships with others.

### Class 'Authorities' {data-height=350} 

<center>
```{r, results = 'asis'}
if (length(as.character(fileList[[1]]$ASList[[2]]) > 0)) {
  cat(fileList[[1]]$ASList[[2]])
} else {
  cat("Network Authority Analysis Encountered an Error")
}
```
</center>

>These tend to be the class members who are  looked up to, or approached for advice or information by their peers: They have high value to others in the group.  They are those whom others identify as having the most highly positive relationships with.

### Fundamental Relationships  {data-height=750}

<center>
```{r, results = 'asis'}
cat(paste(fileList[[1]]$totalNetworkInfo[[2]][[9]][1,1], "<br>", "and<br>",
          fileList[[1]]$totalNetworkInfo[[2]][[9]][1,2])
    )
```

***

```{r, results = 'asis'}
cat(paste(fileList[[1]]$totalNetworkInfo[[2]][[9]][2,1], "<br>", "and<br>",
          fileList[[1]]$totalNetworkInfo[[2]][[9]][2,2])
    )
```

***

```{r, results = 'asis'}
cat(paste(fileList[[1]]$totalNetworkInfo[[2]][[9]][3,1], "<br>", "and<br>",
          fileList[[1]]$totalNetworkInfo[[2]][[9]][3,2])
    )
```
</center>

>These are the relationships which make the class operate as it does.  Promoting
these adds cohesion.

### Network Isolates

<center>
```{r, results = 'asis'}
if(!is.null(fileList[[1]]$isolatesList[[2]])) {
  cat(fileList[[1]]$isolatesList[[2]])
}
```
</center>

>These people are not joined to any others in the network by positive
relationships in at least one of the dimensions they were asked about.

Scots 7TGAN1 RQ3 Relationship Question
=======================================================================
  
Headlines {data-width=200}
--------------------------------------------------------------------------

### Question Statement: Relationships Question 3

```{r}
valueBox(
  "RQ3",
  caption = NULL,
  color = '#186ecc',
  icon = "fa-comment"
)
```

### {-}

```{r}
valueBox(
  fileList[[1]]$className,
  caption = NULL,
  color = '#186ecc',
  icon = "fa-chalkboard-teacher"
)
```

### Network Health

```{r}
valueBox(
  fileList[[1]]$overallHealth[[3]][[1]],
  color = fileList[[1]]$overallHealth[[3]][[2]],
  icon = "fa-file-medical"
)
```

### Potential for Improvement

```{r}
valueBox(
  fileList[[1]]$overallPfI[[3]][[1]],
  color = fileList[[1]]$overallPfI[[3]][[2]],
  icon = "fa-chart-line"
)
```

### Our Commentary

  The data shown here is a result of analysis conducted upon the social
network data provided by completing our Relationships Foundation
Questionnaires, along with any other information provided to us by you
and/or `r fileList[[1]]$clientName`.

### Class Predictive Factors

<center>
```{r, results = 'asis'}
if (length(fileList[[1]]$homophylyList[[3]][[1]] > 0)) {
  cat(fileList[[1]]$homophylyList[[3]][[1]])
} else {
  cat("None")
}
```
</center>

>These factors statistically significantly influence the nature and function of the class

### Class Indeterminate Factors

<center>
```{r, results = 'asis'}
if (length(fileList[[1]]$homophylyList[[3]][[3]] > 0)) {
  cat(fileList[[1]]$homophylyList[[3]][[3]])
} else {
  cat("None")
}
```
</center>

>These factors could not be shown to influence the nature and function of the class at a peer-to-peer level due to limitations in the data collected

### Class Non-Predictive Factors

<center>
```{r, results = 'asis'}
if (length(fileList[[1]]$homophylyList[[3]][[2]] > 0)) {
  cat(fileList[[1]]$homophylyList[[3]][[2]])
} else {
  cat("None")
}
```
</center>

>These factors do not statistically significantly influence the nature and
function of the class

Row {data-width=250}
-----------------------------------------------------------------------

### Class Diameter

```{r}
diameter <- fileList[[1]]$totalNetworkInfo[[3]][[4]][[1]]
nodes <- length(fileList[[1]]$totalNetworkInfo[[3]][[10]])

source("./assets/R/graphConnected.R")

if(graphConnected(fileList[[1]]$SSNQGraph[[3]])== F) {
  customSectors <-  gaugeSectors (
    danger = c(0, 100)
  )
} else {
  customSectors <-  gaugeSectors (
    success = c(0,(nodes/6)),
    warning = c((nodes/6), (nodes/3)),
    danger = c((nodes/3), (nodes/2)))
}

#make gauge
gauge(round(diameter, digits = 2), min = 1, max = (nodes/2), sectors = customSectors)

#provide warning text if graph is fragmented.
if (graphConnected(fileList[[1]]$SSNQGraph[[3]]) == F) {
  SSNQConnectedWarning <- paste("However, as this group is split across ",
    "separate unconnected sub-groups, this may not be a good measure of group ",
    "cohesiveness.",
    sep = "")
} else {
  SSNQConnectedWarning <- ""
}
```
 
> The most distant people are `r round(diameter, digits=0)` relationships away
from each other. <span style="color: red;">`r SSNQConnectedWarning`</span> 

### Percentage of Positive Relationships

```{r}
edgeDensity <- fileList[[1]]$totalNetworkInfo[[3]][[5]]
edgeDensityPercentage <- round((edgeDensity*100), digits = 0)
gauge(edgeDensityPercentage, min = 0, max = 100, symbol = '%', gaugeSectors(
    success = c(21, 100), 
    warning = c(16, 20), 
    danger = c(0, 15)
  ))
```
  
> `r round(edgeDensity, digits = 2)*100`% of all possible relationships are
strongly positive.
  
### Class Reciprocity
  
```{r}
reciprocity <- fileList[[1]]$totalNetworkInfo[[3]][[6]]
reciprocityPercentage <- round((reciprocity*100), digits = 0)
gauge(reciprocityPercentage, min = 0, max = 100, symbol = '%', gaugeSectors(
    success = c(55, 100), 
    warning = c(40, 54), 
    danger = c(0, 39)
  ))
```

> Both parties agreed on a relationship status
`r round(reciprocity, digits = 2)*100`% of the time.

### Class Communities Dendrogram  {data-height=400} 
<center>
```{r}

fileList[[1]]$dendrogramList[[3]]

```
</center>

> This shows how the relational landscape divides into subgroups, mirrored in the colour of the dots on the summary graph.  The higher the number on the left, the bigger the distance between the group members attached at the split.
  

Network Maps 
----------------------------------------------------------------

### Summary graph {.no-padding data-height=700} 

```{r}

JSData1 <- jsonlite::read_json("D3JSData11.json")

repeatedforcedirectedOutput("repeatedforcedirected1")
output$repeatedforcedirected1 <- renderRepeatedforcedirected(repeatedforcedirected("Hello", JSData1))
```

> The lines on this graph represent the strongest relationships in the class. Each dot is a person, and each line is a strong relationship. The colours indicate cliques, or subgroups in the data which naturally form as people form and maintain social networks. Zoom using the scroll wheel or pinch on a touchscreen device, and drag people around to see who is connected most closely to them. The position on the graph doesn't matter itself, its about the position relative to the other people and how linked in they are with the group as a whole.

Key Network Information {data-width=250}
-----------------------------------------------------

### Class 'Hubs' {data-height=350} 

<center>
```{r, results = 'asis'}
if (length(fileList[[1]]$HSList[[3]]) > 0) {
  cat(fileList[[1]]$HSList[[3]])
} else {
  cat("Contact Volume Hub Analysis Encountered an Error")
}
```
</center>

> These people are the lifeblood of the class: Their absence would hamper communication and they make good contacts for new members to get more integrated.  They are those who report the most highly positive relationships with others.

### Class 'Authorities' {data-height=350} 

<center>
```{r, results = 'asis'}
if (length(as.character(fileList[[1]]$ASList[[3]]) > 0)) {
  cat(fileList[[1]]$ASList[[3]])
} else {
  cat("Network Authority Analysis Encountered an Error")
}
```
</center>

>These tend to be the class members who are  looked up to, or approached for advice or information by their peers: They have high value to others in the group.  They are those whom others identify as having the most highly positive relationships with.

### Fundamental Relationships  {data-height=750}

<center>
```{r, results = 'asis'}
cat(paste(fileList[[1]]$totalNetworkInfo[[3]][[9]][1,1], "<br>", "and<br>",
          fileList[[1]]$totalNetworkInfo[[3]][[9]][1,2])
    )
```

***

```{r, results = 'asis'}
cat(paste(fileList[[1]]$totalNetworkInfo[[3]][[9]][2,1], "<br>", "and<br>",
          fileList[[1]]$totalNetworkInfo[[3]][[9]][2,2])
    )
```

***

```{r, results = 'asis'}
cat(paste(fileList[[1]]$totalNetworkInfo[[3]][[9]][3,1], "<br>", "and<br>",
          fileList[[1]]$totalNetworkInfo[[3]][[9]][3,2])
    )
```
</center>

>These are the relationships which make the class operate as it does.  Promoting
these adds cohesion.

### Network Isolates

<center>
```{r, results = 'asis'}
if(!is.null(fileList[[1]]$isolatesList[[3]])) {
  cat(fileList[[1]]$isolatesList[[3]])
}
```
</center>

>These people are not joined to any others in the network by positive
relationships in at least one of the dimensions they were asked about.

Scots 7TGAN1 RQ4 Relationship Question
=======================================================================
  
Headlines {data-width=200}
--------------------------------------------------------------------------

### Question Statement: Relationships Question 4

```{r}
valueBox(
  "RQ4",
  caption = NULL,
  color = '#186ecc',
  icon = "fa-comment"
)
```

### {-}

```{r}
valueBox(
  fileList[[1]]$className,
  caption = NULL,
  color = '#186ecc',
  icon = "fa-chalkboard-teacher"
)
```

### Network Health

```{r}
valueBox(
  fileList[[1]]$overallHealth[[4]][[1]],
  color = fileList[[1]]$overallHealth[[4]][[2]],
  icon = "fa-file-medical"
)
```

### Potential for Improvement

```{r}
valueBox(
  fileList[[1]]$overallPfI[[4]][[1]],
  color = fileList[[1]]$overallPfI[[4]][[2]],
  icon = "fa-chart-line"
)
```

### Our Commentary

  The data shown here is a result of analysis conducted upon the social
network data provided by completing our Relationships Foundation
Questionnaires, along with any other information provided to us by you
and/or `r fileList[[1]]$clientName`.

### Class Predictive Factors

<center>
```{r, results = 'asis'}
if (length(fileList[[1]]$homophylyList[[4]][[1]] > 0)) {
  cat(fileList[[1]]$homophylyList[[4]][[1]])
} else {
  cat("None")
}
```
</center>

>These factors statistically significantly influence the nature and function of the class

### Class Indeterminate Factors

<center>
```{r, results = 'asis'}
if (length(fileList[[1]]$homophylyList[[4]][[3]] > 0)) {
  cat(fileList[[1]]$homophylyList[[4]][[3]])
} else {
  cat("None")
}
```
</center>

>These factors could not be shown to influence the nature and function of the class at a peer-to-peer level due to limitations in the data collected

### Class Non-Predictive Factors

<center>
```{r, results = 'asis'}
if (length(fileList[[1]]$homophylyList[[4]][[2]] > 0)) {
  cat(fileList[[1]]$homophylyList[[4]][[2]])
} else {
  cat("None")
}
```
</center>

>These factors do not statistically significantly influence the nature and
function of the class

Row {data-width=250}
-----------------------------------------------------------------------

### Class Diameter

```{r}
diameter <- fileList[[1]]$totalNetworkInfo[[4]][[4]][[1]]
nodes <- length(fileList[[1]]$totalNetworkInfo[[4]][[10]])

source("./assets/R/graphConnected.R")

if(graphConnected(fileList[[1]]$SSNQGraph[[4]])== F) {
  customSectors <-  gaugeSectors (
    danger = c(0, 100)
  )
} else {
  customSectors <-  gaugeSectors (
    success = c(0,(nodes/6)),
    warning = c((nodes/6), (nodes/3)),
    danger = c((nodes/3), (nodes/2)))
}

#make gauge
gauge(round(diameter, digits = 2), min = 1, max = (nodes/2), sectors = customSectors)

#provide warning text if graph is fragmented.
if (graphConnected(fileList[[1]]$SSNQGraph[[4]]) == F) {
  SSNQConnectedWarning <- paste("However, as this group is split across ",
    "separate unconnected sub-groups, this may not be a good measure of group ",
    "cohesiveness.",
    sep = "")
} else {
  SSNQConnectedWarning <- ""
}
```
 
> The most distant people are `r round(diameter, digits=0)` relationships away
from each other. <span style="color: red;">`r SSNQConnectedWarning`</span> 

### Percentage of Positive Relationships

```{r}
edgeDensity <- fileList[[1]]$totalNetworkInfo[[4]][[5]]
edgeDensityPercentage <- round((edgeDensity*100), digits = 0)
gauge(edgeDensityPercentage, min = 0, max = 100, symbol = '%', gaugeSectors(
    success = c(21, 100), 
    warning = c(16, 20), 
    danger = c(0, 15)
  ))
```
  
> `r round(edgeDensity, digits = 2)*100`% of all possible relationships are
strongly positive.
  
### Class Reciprocity
  
```{r}
reciprocity <- fileList[[1]]$totalNetworkInfo[[4]][[6]]
reciprocityPercentage <- round((reciprocity*100), digits = 0)
gauge(reciprocityPercentage, min = 0, max = 100, symbol = '%', gaugeSectors(
    success = c(55, 100), 
    warning = c(40, 54), 
    danger = c(0, 39)
  ))
```

> Both parties agreed on a relationship status
`r round(reciprocity, digits = 2)*100`% of the time.

### Class Communities Dendrogram  {data-height=400} 
<center>
```{r}

fileList[[1]]$dendrogramList[[4]]

```
</center>

> This shows how the relational landscape divides into subgroups, mirrored in the colour of the dots on the summary graph.  The higher the number on the left, the bigger the distance between the group members attached at the split.
  

Network Maps 
----------------------------------------------------------------

### Summary graph {.no-padding data-height=700} 

```{r}

JSData1 <- jsonlite::read_json("D3JSData11.json")

repeatedforcedirectedOutput("repeatedforcedirected1")
output$repeatedforcedirected1 <- renderRepeatedforcedirected(repeatedforcedirected("Hello", JSData1))
```

> The lines on this graph represent the strongest relationships in the class. Each dot is a person, and each line is a strong relationship. The colours indicate cliques, or subgroups in the data which naturally form as people form and maintain social networks. Zoom using the scroll wheel or pinch on a touchscreen device, and drag people around to see who is connected most closely to them. The position on the graph doesn't matter itself, its about the position relative to the other people and how linked in they are with the group as a whole.

Key Network Information {data-width=250}
-----------------------------------------------------

### Class 'Hubs' {data-height=350} 

<center>
```{r, results = 'asis'}
if (length(fileList[[1]]$HSList[[4]]) > 0) {
  cat(fileList[[1]]$HSList[[4]])
} else {
  cat("Contact Volume Hub Analysis Encountered an Error")
}
```
</center>

> These people are the lifeblood of the class: Their absence would hamper communication and they make good contacts for new members to get more integrated.  They are those who report the most highly positive relationships with others.

### Class 'Authorities' {data-height=350} 

<center>
```{r, results = 'asis'}
if (length(as.character(fileList[[1]]$ASList[[4]]) > 0)) {
  cat(fileList[[1]]$ASList[[4]])
} else {
  cat("Network Authority Analysis Encountered an Error")
}
```
</center>

>These tend to be the class members who are  looked up to, or approached for advice or information by their peers: They have high value to others in the group.  They are those whom others identify as having the most highly positive relationships with.

### Fundamental Relationships  {data-height=750}

<center>
```{r, results = 'asis'}
cat(paste(fileList[[1]]$totalNetworkInfo[[4]][[9]][1,1], "<br>", "and<br>",
          fileList[[1]]$totalNetworkInfo[[4]][[9]][1,2])
    )
```

***

```{r, results = 'asis'}
cat(paste(fileList[[1]]$totalNetworkInfo[[4]][[9]][2,1], "<br>", "and<br>",
          fileList[[1]]$totalNetworkInfo[[4]][[9]][2,2])
    )
```

***

```{r, results = 'asis'}
cat(paste(fileList[[1]]$totalNetworkInfo[[4]][[9]][3,1], "<br>", "and<br>",
          fileList[[1]]$totalNetworkInfo[[4]][[9]][3,2])
    )
```
</center>

>These are the relationships which make the class operate as it does.  Promoting
these adds cohesion.

### Network Isolates

<center>
```{r, results = 'asis'}
if(!is.null(fileList[[1]]$isolatesList[[4]])) {
  cat(fileList[[1]]$isolatesList[[4]])
}
```
</center>

>These people are not joined to any others in the network by positive
relationships in at least one of the dimensions they were asked about.

